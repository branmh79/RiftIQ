<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summoner Profile</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 100px 360px 20px 360px;
            background: linear-gradient(225deg,#534258, #3a3a3a);
            color: #ffffff; /* White text for readability */
        }

        .search-bar-container {
            display: flex;
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
            gap: 15px;
            position: absolute; /* Keep it positioned relative to the viewport */
            top: 50px; /* Adjust top positioning as needed */
            left: 50%;
            transform: translateX(-50%); /* Center align the search bar */
            width: 60%;
            max-width: 1000px;
        }
    
        .search-logo {
            height: 50px;  /* Adjust to the height of the search bar */
            width: auto;
        }
        
        .search-form {
            display: flex;
            gap: 10px;
            background-color:#181718;
            padding: 6px 10px;
            border-radius: 5px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.5);
            width: 100%;  /* Make the search bar take up all available space */
        }
        
        .search-form input,
        .search-form button {
            padding: 6px 8px;
            border-radius: 5px;
            height: 30px;  /* Match the height of the search bar */
        }
        
        .search-form input {
            flex-grow: 1;  /* Make the input take up most of the space */
        }
        
        .search-form button {
            background-color: #e63946;
            padding 10px 20px;
            border-radius: 5px;
            height: 45px;
            width: 80px;
            color: white;
            border: none;
            cursor: pointer;
        }
        
        .search-form button:hover {
            background-color: #d62828;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 20px; /* Space between child containers */
            padding: 20px; /* Ensure consistent padding inside the parent container */
            margin-top: 30px; /* Add margin to account for the fixed search bar */
        }

        .refresh-button {
            align-self: flex-start; /* Align button to the left */
            width: 80px; /* Keep the button's fixed width */
            height: 35px; /* Maintain consistent button height */
            display: flex;
            justify-content: center; /* Center content inside the button */
            align-items: center; /* Align spinner and text vertically */
            background-color: #e63946;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 0px;
        }
        
        .refresh-button:hover {
            background-color: #d62828;
        }
        
        .refresh-container {
            display: flex;
            flex-direction: column; /* Stack the button and text vertically */
            align-items: flex-start;  /* Align to the right */
        }
        
        .last-updated {
            margin-top: 0; /* Remove top margin */
            margin-bottom: 0; /* Remove bottom margin */
            font-size: 12px;
            color: #ffffff;
        }

        .profile-info-container {
            display: flex;
            align-items: center; /* Vertically align items */
            gap: 15px; /* Space between icon and details */
        }

        .profile-icon-container {
            display: flex;
            flex-direction: column; /* Stack icon and level vertically */
            align-items: center; /* Center-align contents */
            gap: 5px; /* Space between icon and level */
            flex: 0 0 auto; /* Prevent resizing */
        }
        
        .profile-text {
            flex: 1; /* Allow the text to take up remaining space */
        }

        .main-container {
            display: flex;
            gap: 20px;
            width: 100%; /* Ensure main-container takes the full width */
            box-sizing: border-box; /* Include padding in width */
        }
        

        .left-container {
            flex: 1; /* Take up one portion of the width */
            display: flex;
            flex-direction: column; /* Stack Ranked Stats and Recently Played Champions */
            gap: 20px; /* Space between the sections */
            max-width: 400px; /* Limit the width of the left container */
        }

        .ranked-stats {
            background: #181718; /* Lighter gray */
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5);
        }

        .recently-played-champions {
            background: #181718; /* Lighter gray */
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5);
            width: 100%; /* Contain it within the left container */
            box-sizing: border-box; /* Ensure padding doesn't affect width */
        }

        .ranked-stats h2{
            margin-bottom: 10px;
        }

        .right-container {
            flex: 2; /* Take up twice the width of the left container */
            background: #181718;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5);
            width: 100%; /* Ensure it stretches to fill the available space */
            box-sizing: border-box; /* Include padding in width calculation */
        }

        .profile-card, .rank-card {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
        }

        .rank-card h2 {
            margin-bottom: 10px;
        }

        .profile-icon {
            margin-right: 10px;
        }
        
        .profile-icon-img {
            width: 80px; /* Increased size */
            height: 80px; /* Increased size */
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.3); /* Slightly thicker border */
        }
        
        .profile-level {
            margin: 0; /* Remove any margin around the text */
            padding: 0; /* Ensure no padding contributes to extra space */
            font-size: 1em; /* Keep size visually prominent */
            font-weight: bold;
            color: #f4a261;
        }
        
        .profile-details-container {
            display: flex;
            flex-direction: column; /* Stack name, button, and updated text vertically */
            justify-content: flex-start;
            flex: 1; /* Allow this section to expand */
            gap: 10px; /* Space between elements */
        }

        .user-info {
            display: flex;
            align-items: baseline; /* Align name and tagline on their baseline */
            gap: 5px; /* Space between username and tagline */
            margin-bottom: 0px; /* Add some space below the name and tagline */
        }

        .summoner-profile-container {
            display: flex;
            flex-direction: row; /* Align items horizontally */
            align-items: flex-start; /* Align items to the top */   
            gap: 20px; /* Space between sections */
            padding: 20px 20px 10px; /* Adjust bottom padding */
            margin-top: 20px; /* Increase distance from the search bar */
            margin-bottom: 20px; /* Default spacing beneath the container */
            position: relative; /* Make this the reference for absolute positioning */
            background: #181718;
            border-radius: 15px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5);
            width: 100%;
            box-sizing: border-box;
        }
        
        .summoner-name {
            font-weight: bold;
            color: #ffffff;
            font-size: 1.8em; /* Larger font size for the username */
        }
        
        .summoner-tag {
            font-weight: normal;
            color: #b0b0b0;
            font-size: 1.4em; /* Slightly larger tagline */
        }

        .champion-list {
            display: flex;
            flex-direction: column; /* Stack champions vertically */
            gap: 10px; /* Space between rows */
        }
        
        .champion-card {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .champion-name {
            font-weight: bold;
            color: #ffffff;
            font-size: 1em;
        }
        
        .games-played, .win-rate {
            font-size: 0.9em;
            color: #f4a261;
        }

        .champion-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 10px;
        }

        .champion-item {
            display: flex;
            align-items: center; /* Vertically align content */
            gap: 10px; /* Space between icon and text */
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            width: auto; /* Prevent the item from stretching unnecessarily */
        }

        .champion-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .champion-stats-card {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
        }

        .champion-stats-card h2 {
            margin-bottom: 10px;
        }

        .champion-stats-list {
            list-style: none;
            padding: 0;
        }

        .champion-stats-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .match-container {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 15px;
            gap: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            background: #181718; /* Lighter gray */
        }

        .match-container.win {
            background-color: #2E4C3F;
        }

        .match-container.loss {
            background-color: rgba(239, 72, 72, 0.2);
        }

        .profile-level {
            color: #ffd700; /* Gold for prominence */
        }

        .match-header img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .match-details {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: flex-start;
        }

        .match-details p {
            margin: 0;
            display: inline-block;
            white-space: nowrap;
        }

        .load-more {
            text-align: center;
            margin: 20px 0;
        }

        .load-more button {
            background-color: #e63946;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .load-more button:hover {
            background-color: #d62828;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            margin-top: 10px;
        }

        .loading-spinner.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .spinner-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px; /* Space between the button and spinner */
        }

        .spinner {
            position: absolute; /* Overlay spinner on the text */
            border: 3px solid rgba(0, 0, 0, 0.2); /* Outer border */
            border-top: 3px solid #ffffff; /* Spinner color */
            border-radius: 50%;
            width: 15px; /* Smaller spinner size */
            height: 15px;
            animation: spin 1s linear infinite;
            display: none; /* Hidden by default */
        }

        /* Button Text */
        #buttonText {
            position: absolute; /* Overlay text on the spinner */
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        .tier-graph-controls {
            position: absolute; /* Position relative to the container */
            top: 10px; /* Align to the top of the container */
            right: 10px; /* Align to the right edge */
            display: flex;
            gap: 10px; /* Space between buttons */
            z-index: 10; /* Ensure buttons are above other elements */
        }
        
        .tier-graph-title {
            text-align: center; /* Center the text */
            font-size: 1.5em; /* Adjust the font size */
            font-weight: bold; /* Make the text bold */
            color: #ffffff; /* White color for visibility */
            margin-bottom: 10px; /* Space below the title */
        }
        
        .tier-graph-header {
        display: flex;
        justify-content: flex-end; /* Align the buttons to the right */
        align-items: center; /* Vertically align buttons */
        width: 100%; /* Take the full width of the container */
        margin-bottom: 10px; /* Space between the header and the graph */
        }

        #tierGraph {
            width: 100%; /* Stretch to fill the width of the container */
            height: 100px; /* Fixed height */
            max-height: none; /* Prevent height constraints */
            box-sizing: border-box; /* Include padding and borders in dimensions */
        }

        .tier-graph-controls {
            display: flex;
            justify-content: flex-end; /* Align buttons to the right */
            gap: 10px; /* Space between buttons */
            width: 100%; /* Ensure buttons stretch across the container */
        }
           
        .tier-graph-controls h4 {
            margin: 0; /* Remove default margin from the <h4> element */
            font-size: 1.3em; /* Adjust font size to match button height */
            font-weight: bold; /* Optional: Make the title bold */
            color: #ffffff; /* White text for visibility */
            margin-top: 3px; /* Moves the block down without affecting internal padding */
        }

        .tier-graph-controls button {
            background-color: #e63946;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .tier-graph-controls button:hover {
            background-color: #d62828;
        }
        
        .tier-graph-container {
            display: flex;
            flex-direction: column; /* Stack graph and content vertically */
            justify-content: stretch;
            align-items: flex-start;
            width: 100%; /* Ensure full width of parent container */
            max-width: 100%; /* Prevent unintended constraints */
            margin-top: 20px; /* Space between buttons and graph */
        }

    </style>
</head>
<body>
    <div class="search-bar-container">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" class="search-logo">
        <form action="/search" method="POST" class="search-form">
            <input type="text" name="game_name" placeholder="Game Name" required>
            <input type="text" name="tag_line" placeholder="#NA1" required>
            <button type="submit">Search</button>
        </form>
    </div>

    <div class="summoner-profile-container">
        <!-- Profile Icon and Level -->
        <div class="profile-icon-container">
            <img src="http://ddragon.leagueoflegends.com/cdn/14.23.1/img/profileicon/{{ summoner_info.profileIconId }}.png" alt="Profile Icon" class="profile-icon-img">
            <p class="profile-level">{{ summoner_info.summonerLevel }}</p>
        </div>
    
        <!-- Name, Tagline, and Update Button -->
        <div class="profile-details-container">
            <div class="user-info">
                <span class="summoner-name">{{ riot_id.gameName }}</span>
                <span class="summoner-tag">#{{ riot_id.tagLine }}</span>
            </div>
            <div class="refresh-container">
                <button onclick="refreshMatches()" class="refresh-button" id="refreshButton">
                    <span id="buttonText">Update</span>
                    <div class="spinner" id="refreshSpinner" style="display: none;"></div>
                </button>
            </div>
            <p id="lastUpdated" class="last-updated">Last updated: {{ last_updated or "Never" }}</p>
        </div>
    
        <!-- Tier Graph Buttons -->
        <div class="tier-graph-controls">
        <h4>Tier Graph</h4>
            <button onclick="updateGraph('day')">Daily</button>
            <button onclick="updateGraph('week')">Weekly</button>
        </div>
    
        <!-- Tier Graph -->
        <div class="tier-graph-container">
            <canvas id="tierGraph"></canvas>
        </div>
    </div>
    
    <div class="main-container">
        <!-- Left Section -->
        <div class="left-container">
            <div class="ranked-stats">
                <h2>Ranked Stats</h2>
                {% if ranked_stats %}
                <p><strong>Rank:</strong> {{ ranked_stats.tier }} {{ ranked_stats.rank }}</p>
                <p><strong>MMR:</strong> {{ mmr_data.estimated_mmr or 'N/A' }} {{ mmr_data.rank_label }}</p>
                <p><strong>Wins:</strong> {{ ranked_stats.wins }}</p>
                <p><strong>Losses:</strong> {{ ranked_stats.losses }}</p>
                <p><strong>Win Rate:</strong> {{ (ranked_stats.wins / (ranked_stats.wins + ranked_stats.losses) * 100) | round(2) }}%</p>
                {% else %}
                <p>No ranked stats available.</p>
                {% endif %}
            </div>
            <div class="recently-played-champions">
                <h2>Recently Played Champions</h2>
                <div class="champion-list">
                    {% for champion in most_played_champions %}
                    <div class="champion-item">
                        <img 
                            src="http://ddragon.leagueoflegends.com/cdn/14.23.1/img/champion/{{ champion.champion }}.png" 
                            alt="{{ champion.champion }}" 
                            class="champion-icon">
                        <span class="champion-name">{{ champion.champion }}</span>
                        <span class="games-played">{{ champion.games_played }} games</span>
                        <span class="win-rate">{{ champion.winrate }} win rate</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    
        <!-- Right Section -->
        <div class="right-container">
            <h2>Match History</h2>
            <div class="match-history-list">
                {% for match in user_match_details %}
                <div class="match-container {% if match.user_data.win %}win{% else %}loss{% endif %}">
                    <div class="match-header">
                        <img 
                            src="{{ match.user_data.champion_icon }}" 
                            alt="{{ match.user_data.championName }}" 
                            onerror="this.src='https://via.placeholder.com/50?text=?'">
                    </div>
                    <div class="match-details">
                        <p><strong>Champion:</strong> {{ match.user_data.championName }}</p>
                        <p><strong>K/D/A:</strong> {{ match.user_data.kills }}/{{ match.user_data.deaths }}/{{ match.user_data.assists }}</p>
                        <p><strong>CS:</strong> {{ match.user_data.totalCS }}</p>
                        <p><strong>Played:</strong> {{ match.game_time_ago }}</p>
                        <p><strong>Game Mode:</strong> {{ match.game_mode }}</p>
                        <p><strong>Duration:</strong> {{ match.game_duration }} minutes</p>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="load-more">
                <button onclick="loadMoreMatches()">Load More Matches</button>
            </div>
            
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p>Loading more matches...</p>
            </div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script>
        let matchStartIndex = 20; // Start after the first 20 matches
        let currentMatchCount = {{ user_match_details | length }};
        let chartInstance; // Declare globally for Chart.js reuse

        function romanToNumber(roman) {
            const romanNumerals = {
                'I': 1,
                'II': 2,
                'III': 3,
                'IV': 4,
                'V': 5,
            };
            return romanNumerals[roman] || roman;
        }
        
        function loadMoreMatches() {
            const userId = "{{ riot_id.gameName }}#{{ riot_id.tagLine }}";
            const startIndex = document.querySelectorAll('.match-container').length; // Count current displayed matches
        
            fetch("/load_more", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    user_id: userId,
                    start: startIndex,
                }),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.message) {
                        alert(data.message); // No more matches to load
                    } else if (data.matches) {
                        appendMatches(data.matches); // Add the new matches below existing ones
                    }
                })
                .catch((error) => {
                    console.error("Error loading more matches:", error);
                });
        }
        

        function refreshMatches() {
            const refreshButton = document.getElementById("refreshButton");
            const buttonText = document.getElementById("buttonText");
            const refreshSpinner = document.getElementById("refreshSpinner");
        
            // Show the spinner and hide the button text
            buttonText.style.display = "none";
            refreshSpinner.style.display = "block";
            refreshButton.disabled = true;
        
            const userId = "{{ riot_id.gameName }}#{{ riot_id.tagLine }}";
        
            fetch("/refresh_matches", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    user_id: userId,
                    region: "{{ region }}",
                }),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.error) {
                        alert("Failed to refresh matches. Please try again.");
                        return;
                    }
        
                    if (data.message) {
                        alert(data.message); // Show backend message (e.g., "No new matches")
                    }
        
                    // Update the Last Updated text
                    const lastUpdatedElement = document.getElementById("lastUpdated");
                    lastUpdatedElement.innerText = `Last updated: ${data.last_updated}`;
        
                    // Clear existing matches from the frontend
                    const matchContainer = document.querySelector(".match-history-list");
                    matchContainer.innerHTML = ""; // Clear the list completely
        
                    if (data.new_matches && data.new_matches.length > 0) {
                        appendMatches(data.new_matches); // Append the updated matches
                    } else if (data.updated_matches && data.updated_matches.length > 0) {
                        appendMatches(data.updated_matches); // Handle no new matches but updated list
                    }
                })
                .catch((error) => {
                    console.error("Error refreshing matches:", error);
                    alert("Failed to refresh matches. Please try again.");
                })
                .finally(() => {
                    // Restore the button text and hide the spinner
                    buttonText.style.display = "block";
                    refreshSpinner.style.display = "none";
                    refreshButton.disabled = false;
                });
        }
        
        
        
        
        function appendMatches(matches) {
            const matchContainer = document.querySelector(".match-history-list");
        
            matches.forEach((match) => {
                // Check if the match already exists in the DOM
                const existingMatch = matchContainer.querySelector(`[data-match-id="${match.match_id}"]`);
                if (existingMatch) {
                    return; // Skip if the match already exists
                }
        
                // Create and append the match element
                const matchElement = document.createElement("div");
                matchElement.className = `match-container ${match.user_data.win ? "win" : "loss"}`;
                matchElement.setAttribute("data-match-id", match.match_id); // Add match ID as a data attribute
                matchElement.innerHTML = `
                    <div class="match-header">
                        <img src="${match.user_data.champion_icon}" 
                             alt="${match.user_data.championName}" 
                             onerror="this.src='https://via.placeholder.com/50?text=?'">
                    </div>
                    <div class="match-details">
                        <p><strong>Champion:</strong> ${match.user_data.championName}</p>
                        <p><strong>K/D/A:</strong> ${match.user_data.kills}/${match.user_data.deaths}/${match.user_data.assists}</p>
                        <p><strong>CS:</strong> ${match.user_data.totalCS}</p>
                        <p><strong>Played:</strong> ${match.game_time_ago}</p>
                        <p><strong>Game Mode:</strong> ${match.game_mode}</p>
                        <p><strong>Duration:</strong> ${match.game_duration} minutes</p>
                    </div>
                `;
                matchContainer.appendChild(matchElement);
            });
        }
        
        

        function updateGraph(timeframe) {
            fetch(`/ranked_graph?timeframe=${timeframe}`)
                .then(response => response.json())
                .then(data => {
                    createGraph(data, timeframe);
                })
                .catch(error => console.error('Error fetching graph data:', error));
        }
        
        
        function createGraph(data, timeframe) {
            const canvas = document.getElementById('tierGraph');
            const ctx = canvas.getContext('2d');
        
            // Set canvas dimensions explicitly
            canvas.width = canvas.offsetWidth;
            canvas.height = 100; // Fixed height for better visibility
        
            // Destroy the existing chart instance if it exists
            if (chartInstance) {
                chartInstance.destroy();
            }
        
            // Create the graph
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Rank Progression',
                        data: data.points,
                        borderColor: '#ffd700',
                        borderWidth: 2,
                        fill: false,
                        pointBackgroundColor: '#ffffff',
                        pointRadius: 4,
                    }]
                },
                options: {
                    responsive: false,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false // Hide legend
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    const rank = data.ranks[context.dataIndex]; // Rank from backend
                                    const lp = context.raw; // LP value
                                    return `${rank} (${lp} LP)`; // Tooltip displays rank and LP
                                }
                            }
                        },
                        datalabels: {
                            anchor: 'end', // Position above points
                            align: 'top', // Align labels above points
                            formatter: function (value, context) {
                                const rank = data.ranks[context.dataIndex];
                                const lp = value;
                                return `${rank}\n${lp} LP`; // Display rank and LP as the label
                            },
                            color: '#ffffff', // White text color
                            font: {
                                size: 12, // Adjust label font size
                                weight: 'bold' // Make labels bold
                            },
                            offset: -10 // Add spacing above the points
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                callback: function (value) {
                                    return this.getLabelForValue(value);
                                }
                            },
                        },
                        y: {
                            min: -14,
                            max: 200,
                            ticks: {
                                display: false, // Hide Y-axis tick labels
                                stepSize: 100, // Maintain internal spacing
                            },
                            grid: {
                                drawTicks: false, // Hide grid tick marks
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels] // Ensure the plugin is loaded
            });            
        }
        
    </script>
</body>
</html>
